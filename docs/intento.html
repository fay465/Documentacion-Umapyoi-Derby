<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Documentación API Gestión de Devoluciones Retail :: Example Documentation</title>
    <link rel="canonical" href="https://ninjascl.github.io/antora-docs-bootstrap/intento.html">
    <link rel="prev" href="index.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="./_/css/site.css">
    <link rel="stylesheet" href="./_/js/vendor/styles/monokai.css">  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://ninjascl.github.io/antora-docs-bootstrap">Example Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Buscar">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <!--
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
    -->
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Example Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="intento.html">Documentación API Gestión de Devoluciones Retail</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Example Documentation</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Example Documentation</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Example Documentation</a></li>
    <li><a href="intento.html">Documentación API Gestión de Devoluciones Retail</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///antora/./modules/ROOT/pages/intento.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contenidos" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Documentación API Gestión de Devoluciones Retail</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#contexto">1. CONTEXTO</a>
<ul class="sectlevel2">
<li><a href="#problema-del-negocio">1.1. Problema del Negocio</a></li>
</ul>
</li>
<li><a href="#hipótesis-y-supuestos">2. HIPÓTESIS Y SUPUESTOS</a>
<ul class="sectlevel2">
<li><a href="#qué-sí-es-el-proyecto">2.1. Qué SÍ es el proyecto:</a></li>
<li><a href="#qué-no-es-el-proyecto">2.2. Qué NO es el proyecto:</a></li>
<li><a href="#supuestos-técnicos-validados">2.3. Supuestos técnicos validados:</a></li>
</ul>
</li>
<li><a href="#métricas-e-impacto">3. MÉTRICAS E IMPACTO</a>
<ul class="sectlevel2">
<li><a href="#kpis-de-negocio-críticos">3.1. KPIs de Negocio Críticos</a></li>
<li><a href="#kpis-de-experiencia-de-usuario">3.2. KPIs de Experiencia de Usuario</a></li>
<li><a href="#kpis-técnicos-de-performance">3.3. KPIs Técnicos de Performance</a></li>
<li><a href="#kpis-de-eficiencia-del-sistema">3.4. KPIs de Eficiencia del Sistema</a></li>
<li><a href="#métricas-de-adopción">3.5. Métricas de Adopción</a></li>
</ul>
</li>
<li><a href="#usuarios-y-clientes">4. USUARIOS Y CLIENTES</a>
<ul class="sectlevel2">
<li><a href="#user-personas">4.1. User Personas</a></li>
<li><a href="#persona-1-cliente-frecuente-maría-gonzález">4.2. Persona 1: Cliente Frecuente - "María González"</a></li>
<li><a href="#persona-2-supervisor-de-tienda-carlos-rodríguez">4.3. Persona 2: Supervisor de Tienda - "Carlos Rodríguez"</a></li>
<li><a href="#flujos-de-negocio-críticos">4.4. Flujos de Negocio Críticos</a>
<ul class="sectlevel3">
<li><a href="#flujo-principal-de-devolución">4.4.1. Flujo Principal de Devolución</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#solución-técnica">5. SOLUCIÓN TÉCNICA</a>
<ul class="sectlevel2">
<li><a href="#resumen-de-la-solución">5.1. Resumen de la solución</a></li>
<li><a href="#requisitos-funcionales">5.2. Requisitos funcionales</a></li>
<li><a href="#restricciones-y-dependencias">5.3. Restricciones y dependencias</a></li>
<li><a href="#criterios-de-aceptación">5.4. Criterios de aceptación</a></li>
</ul>
</li>
<li><a href="#estrategia-de-lanzamiento">6. ESTRATEGIA DE LANZAMIENTO</a>
<ul class="sectlevel2">
<li><a href="#plan-de-release-por-fases">6.1. Plan de Release por Fases</a></li>
<li><a href="#áreas-impactadas-matriz-raci">6.2. Áreas Impactadas - Matriz RACI</a></li>
</ul>
</li>
<li><a href="#preguntas-y-respuestas">7. PREGUNTAS Y RESPUESTAS</a>
<ul class="sectlevel2">
<li><a href="#preguntas-abiertas-críticas">7.1. Preguntas Abiertas Críticas</a></li>
<li><a href="#faq-preguntas-frecuentes">7.2. FAQ - Preguntas Frecuentes</a></li>
</ul>
</li>
<li><a href="#contingencias-y-riesgos">8. CONTINGENCIAS Y RIESGOS</a>
<ul class="sectlevel2">
<li><a href="#plan-de-mitigación">8.1. Plan de Mitigación</a></li>
</ul>
</li>
<li><a href="#diagrama-c4">9. DIAGRAMA C4</a>
<ul class="sectlevel2">
<li><a href="#nivel-1-contexto-del-sistema">9.1. Nivel 1 - Contexto del Sistema</a></li>
<li><a href="#nivel-2-contenedores">9.2. Nivel 2 - Contenedores</a></li>
</ul>
</li>
<li><a href="#diagrama-entidad-relación">10. DIAGRAMA ENTIDAD-RELACIÓN</a></li>
<li><a href="#architecture-decision-records-adr">11. ARCHITECTURE DECISION RECORDS (ADR)</a>
<ul class="sectlevel2">
<li><a href="#adr-001-microservicios-vs-monolito">11.1. ADR 001: Microservicios vs Monolito</a></li>
<li><a href="#adr-002-estrategia-de-base-de-datos">11.2. ADR 002: Estrategia de Base de Datos</a></li>
</ul>
</li>
<li><a href="#especificación-de-endpoints">12. ESPECIFICACIÓN DE ENDPOINTS</a>
<ul class="sectlevel2">
<li><a href="#crear-devolución">12.1. Crear Devolución</a></li>
<li><a href="#consultar-estado">12.2. Consultar Estado</a></li>
<li><a href="#procesar-devolución">12.3. Procesar Devolución</a></li>
</ul>
</li>
<li><a href="#estrategia-de-implementación">13. ESTRATEGIA DE IMPLEMENTACIÓN</a>
<ul class="sectlevel2">
<li><a href="#fase-1-mvp-6-semanas">13.1. Fase 1 (MVP - 6 semanas)</a></li>
<li><a href="#fase-2-8-semanas">13.2. Fase 2 (8 semanas)</a></li>
<li><a href="#fase-3-6-semanas">13.3. Fase 3 (6 semanas)</a></li>
</ul>
</li>
<li><a href="#stack-tecnológico">14. STACK TECNOLÓGICO</a>
<ul class="sectlevel2">
<li><a href="#backend">14.1. Backend</a></li>
<li><a href="#frontend">14.2. Frontend</a></li>
<li><a href="#devops">14.3. DevOps</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="contexto"><a class="anchor" href="#contexto"></a>1. CONTEXTO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="problema-del-negocio"><a class="anchor" href="#problema-del-negocio"></a>1.1. Problema del Negocio</h3>
<div class="paragraph lead">
<p><strong>Problema Principal</strong>: El proceso actual de devoluciones en la cadena de retail maneja:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Tiempo de procesamiento</strong>: 3-5 días hábiles por devolución</p>
</li>
<li>
<p><strong>Costo operacional</strong>: $15-20 USD por devolución manual</p>
</li>
<li>
<p><strong>Tasa de error</strong>: 12% en procesamiento manual</p>
</li>
<li>
<p><strong>Insatisfacción cliente</strong>: 35% de clientes reportan mala experiencia en devoluciones</p>
</li>
<li>
<p><strong>Pérdida por fraudes</strong>: 8% del total de devoluciones son fraudulentas no detectadas</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Necesidad crítica</strong>: Automatización que reduzca costos operacionales y mejore la experiencia del cliente, manteniendo la capacidad de procesar 10M de transacciones diarias.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hipótesis-y-supuestos"><a class="anchor" href="#hipótesis-y-supuestos"></a>2. HIPÓTESIS Y SUPUESTOS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="qué-sí-es-el-proyecto"><a class="anchor" href="#qué-sí-es-el-proyecto"></a>2.1. Qué SÍ es el proyecto:</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Sistema transaccional</strong> de alta velocidad para gestión de devoluciones</p>
</li>
<li>
<p><strong>Motor de reglas</strong> para validación automática de políticas (5 dias para la devolucion)</p>
</li>
<li>
<p><strong>Integrador</strong> con sistemas de inventario, ventas y devoluciones</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="qué-no-es-el-proyecto"><a class="anchor" href="#qué-no-es-el-proyecto"></a>2.2. Qué NO es el proyecto:</h3>
<div class="ulist">
<ul>
<li>
<p>❌ No es un sistema de ventas POS</p>
</li>
<li>
<p>❌ No es un ERP completo</p>
</li>
<li>
<p>❌ No maneja logística física</p>
</li>
<li>
<p>❌ No reemplaza sistemas contables existentes</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="supuestos-técnicos-validados"><a class="anchor" href="#supuestos-técnicos-validados"></a>2.3. Supuestos técnicos validados:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Volumen</strong>: 10'000.000 transacciones/día = ~2.777 transacciones/segundo (peak)</p>
</li>
<li>
<p><strong>Disponibilidad</strong>: Requerimiento 99.99% = ~52 minutos downtime/año máximo</p>
</li>
<li>
<p><strong>Latencia</strong>: &lt;200ms para 95% de las transacciones</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="métricas-e-impacto"><a class="anchor" href="#métricas-e-impacto"></a>3. MÉTRICAS E IMPACTO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="kpis-de-negocio-críticos"><a class="anchor" href="#kpis-de-negocio-críticos"></a>3.1. KPIs de Negocio Críticos</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Categoría</th>
<th class="tableblock halign-left valign-top">KPI</th>
<th class="tableblock halign-left valign-top">Línea Base</th>
<th class="tableblock halign-left valign-top">Meta 6 meses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eficiencia Operacional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiempo promedio procesamiento (horas)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">72-120</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Costo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Costo por devolución (USD)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatización</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa auto-aprobación (%)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calidad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa error procesamiento (%)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fraude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Efectividad detección fraudes (%)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="kpis-de-experiencia-de-usuario"><a class="anchor" href="#kpis-de-experiencia-de-usuario"></a>3.2. KPIs de Experiencia de Usuario</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">KPI</th>
<th class="tableblock halign-left valign-top">Definición</th>
<th class="tableblock halign-left valign-top">Meta</th>
<th class="tableblock halign-left valign-top">Frecuencia</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSAT Devoluciones</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Satisfacción post-devolución (1-5)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.5/5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diaria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa Abandono</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solicitudes iniciadas no completadas (%)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;5%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Semanal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiempo Primera Respuesta</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minutos hasta primer contacto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;30 min</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diaria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NPS Proceso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Net Promoter Score específico</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mensual</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="kpis-técnicos-de-performance"><a class="anchor" href="#kpis-técnicos-de-performance"></a>3.3. KPIs Técnicos de Performance</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">KPI</th>
<th class="tableblock halign-left valign-top">Objetivo</th>
<th class="tableblock halign-left valign-top">Alerta</th>
<th class="tableblock halign-left valign-top">Crítico</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latencia P95</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;200ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disponibilidad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99.99%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99.9%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99.5%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Throughput Máximo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">150 trans/segundo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">120 trans/segundo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 trans/segundo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;0.1%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiempo Respuesta BD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;50ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200ms</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="kpis-de-eficiencia-del-sistema"><a class="anchor" href="#kpis-de-eficiencia-del-sistema"></a>3.4. KPIs de Eficiencia del Sistema</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">KPI</th>
<th class="tableblock halign-left valign-top">Propósito</th>
<th class="tableblock halign-left valign-top">Meta</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Costo por Transacción</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eficiencia infraestructura</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;$0.001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Utilización Recursos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optimización capacidad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65-75%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiempo Escalado</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Segundos para escalar automático</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;30s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa Cache Hit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Efectividad cache Redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;95%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="métricas-de-adopción"><a class="anchor" href="#métricas-de-adopción"></a>3.5. Métricas de Adopción</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Métrica</th>
<th class="tableblock halign-left valign-top">Indicador de Evolución</th>
<th class="tableblock halign-left valign-top">Meta 3 meses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Penetración Digital</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">% devoluciones por app vs tienda física</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uso Self-Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solicitudes completadas sin asistencia</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tasa Retención</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clientes que repiten proceso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adopción por Tienda</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">% tiendas usando sistema activamente</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100%</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usuarios-y-clientes"><a class="anchor" href="#usuarios-y-clientes"></a>4. USUARIOS Y CLIENTES</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="user-personas"><a class="anchor" href="#user-personas"></a>4.1. User Personas</h3>

</div>
<div class="sect2">
<h3 id="persona-1-cliente-frecuente-maría-gonzález"><a class="anchor" href="#persona-1-cliente-frecuente-maría-gonzález"></a>4.2. Persona 1: Cliente Frecuente - "María González"</h3>
<div class="paragraph">
<p>--agregar imagen
image::customer_persona.png[María González, cliente frecuente, 200, 200]</p>
</div>
<div class="paragraph">
<p><strong>Perfil Demográfico</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Edad: 35 años</p>
</li>
<li>
<p>Ocupación: Ejecutiva en empresa tecnológica</p>
</li>
<li>
<p>Ubicación: Urbana, ciudad principal</p>
</li>
<li>
<p>Nivel Tecnológico: Alta competencia digital</p>
</li>
<li>
<p>Frecuencia Compras: 2-3 veces por semana</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Contexto y Comportamiento</strong>:
María realiza la mayoría de sus compras online y valora enormemente su tiempo. Como madre trabajadora, necesita procesos eficientes que se adapten a su apretada agenda. Prefiere resolver problemas por sí misma usando su smartphone antes que contactar servicio al cliente.</p>
</div>
<div class="paragraph">
<p><strong>Horarios de Actividad</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mañanas (7:00-9:00): Revisión rápida en el transporte</p>
</li>
<li>
<p>Tardes (18:00-20:00): Compras y gestiones desde casa</p>
</li>
<li>
<p>Fines de semana: Compras familiares y planificación</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Expectativas Clave</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Procesos digitales sin necesidad de impresión o papeleo</p>
</li>
<li>
<p>Transparencia total en el estado de sus gestiones</p>
</li>
<li>
<p>Resolución en rapida</p>
</li>
<li>
<p>Opciones flexibles de reembolso o cambio</p>
</li>
<li>
<p>Comunicación proactiva sin tener que hacer seguimiento</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Requerimientos</strong>:
* Tener que imprimir formularios o visitar tiendas físicas para trámites simples
* Falta de visibilidad sobre el estado de sus devoluciones
* Tiempos de respuesta lentos que afectan su planificación financiera
* Diferentes procesos según el producto o categoría</p>
</div>
<div class="paragraph">
<p><strong>Escenario de Uso Ideal</strong>:
"Quiero poder gestionar una devolución durante mi viaje en metro matutino, recibir confirmación inmediata y saber exactamente cuándo y cómo recibiré mi reembolso, todo desde mi teléfono sin tener que llamar a nadie"</p>
</div>
</div>
<div class="sect2">
<h3 id="persona-2-supervisor-de-tienda-carlos-rodríguez"><a class="anchor" href="#persona-2-supervisor-de-tienda-carlos-rodríguez"></a>4.3. Persona 2: Supervisor de Tienda - "Carlos Rodríguez"</h3>
<div class="paragraph">
<p>--agregar imagen
image::supervisor_persona.png[Carlos Rodríguez, supervisor de tienda, 200, 200]</p>
</div>
<div class="paragraph">
<p><strong>Perfil Demográfico</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Edad: 42 años</p>
</li>
<li>
<p>Ocupación: Supervisor de operaciones en tienda flagship</p>
</li>
<li>
<p>Experiencia: 15 años en retail</p>
</li>
<li>
<p>Ubicación: Tienda principal en centro comercial</p>
</li>
<li>
<p>Dispositivo Principal: Tablet corporativa y terminal POS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Contexto y Responsabilidades</strong>:
Carlos gestiona un equipo de personas en la tienda de mayor volumen de la cadena. Su desempeño se mide por métricas operativas como tiempo de procesamiento, satisfacción del cliente y eficiencia del personal. Trabaja bajo presión constante para balancear la experiencia del cliente con los procedimientos operativos.</p>
</div>
<div class="paragraph">
<p><strong>Flujo de Trabajo Diario</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>8:00-10:00: Revisión métricas del día anterior y planificación</p>
</li>
<li>
<p>10:00-14:00: Supervisión piso de ventas y resolución de incidencias</p>
</li>
<li>
<p>14:00-16:00: Reuniones operativas y reportes</p>
</li>
<li>
<p>16:00-18:00: Capacitación equipo y cierre operativo</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Requerimientos</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Visión en tiempo real del volumen de devoluciones pendientes</p>
</li>
<li>
<p>Herramientas para priorizar casos urgentes o de alto valor</p>
</li>
<li>
<p>Capacidad de tomar decisiones excepcionales con información completa</p>
</li>
<li>
<p>Reportes automáticos de desempeño de su equipo</p>
</li>
<li>
<p>Integración fluida con sistemas de inventario y caja</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Problemas organizacionales</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sistemas desconectados que requieren ingresar la misma información múltiples veces</p>
</li>
<li>
<p>Falta de visibilidad sobre el historial completo del cliente</p>
</li>
<li>
<p>Procesos manuales que consumen tiempo valioso de atención al cliente</p>
</li>
<li>
<p>Dificultad para escalar problemas complejos a áreas especializadas</p>
</li>
<li>
<p>Limitada capacidad de análisis para identificar patrones o oportunidades de mejora</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Escenario de Uso Ideal</strong>:
"Necesito tener la informacion instantáneamente del estado de todas las devoluciones en mi tienda, me alerte sobre casos que requieren mi atención específica y me permita resolver la mayoría de las situaciones con un par de clicks, manteniendo el flujo de la tienda"</p>
</div>
</div>
<div class="sect2">
<h3 id="flujos-de-negocio-críticos"><a class="anchor" href="#flujos-de-negocio-críticos"></a>4.4. Flujos de Negocio Críticos</h3>
<div class="sect3">
<h4 id="flujo-principal-de-devolución"><a class="anchor" href="#flujo-principal-de-devolución"></a>4.4.1. Flujo Principal de Devolución</h4>
<div class="paragraph">
<p><strong>Inicio del Proceso</strong>:
El flujo se activa cuando un cliente solicita una devolución a través de cualquiera de los canales habilitados: aplicación móvil, sitio web o directamente en tienda física. El sistema captura automáticamente la información básica de la transacción original.</p>
</div>
<div class="paragraph">
<p><strong>Validación Inicial y Crítica</strong>:
La primera y única regla automática aplicada actualmente es la validación del período de 5 días desde la fecha de compra. El sistema calcula exactamente el tiempo transcurrido y determina si la solicitud cumple con este requisito fundamental.</p>
</div>
<div class="paragraph">
<p><strong>Escenarios de Validación:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Aprobado automático: Si la solicitud está dentro del período de 5 días</p>
</li>
<li>
<p>Rechazo automático: Si ha transcurrido más de 5 días desde la compra</p>
</li>
<li>
<p>Escalación manual: Casos especiales que requieren supervisión humana</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Proceso de Aprobación</strong>:
Para las solicitudes que pasan la validación inicial, el sistema genera automáticamente un código QR único que sirve como comprobante digital. Este código contiene toda la información necesaria para procesar la devolución en tienda.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solución-técnica"><a class="anchor" href="#solución-técnica"></a>5. SOLUCIÓN TÉCNICA</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="resumen-de-la-solución"><a class="anchor" href="#resumen-de-la-solución"></a>5.1. Resumen de la solución</h3>
<div class="paragraph">
<p>La plataforma de gestión de devoluciones se concibe como un sistema unificado que transforma la experiencia del cliente y optimiza las operaciones internas del retail. La solución aborda las necesidades fundamentales mediante un proceso completamente digitalizado que elimina las dificultades actuales, proporcionando transparencia total y agilidad en cada etapa. Para el negocio, se establece una infraestructura escalable que reduce costos operativos mediante automatización inteligente y provee capacidades avanzadas de analítica para la toma de decisiones.</p>
</div>
<div class="paragraph">
<p>El alcance comprende el primer contacto para devoluciones, integrando de manera logica la fuente única de datos que contiene la informacion de clientes, ventas, productos y devoluciones.</p>
</div>
<div class="paragraph">
<p>===Nivel de Contexto
---Agregar modelo C4(1)</p>
</div>
<div class="paragraph">
<p>===Nivel de Contenedores
---Agregar modelo C4(2)</p>
</div>
<div class="paragraph">
<p>===Modelo Entidad-Relacion Base de Datos
---Agregar modelo entidad Relacion</p>
</div>
</div>
<div class="sect2">
<h3 id="requisitos-funcionales"><a class="anchor" href="#requisitos-funcionales"></a>5.2. Requisitos funcionales</h3>
<div class="paragraph">
<p>El sistema debe proporcionar capacidades de gestión de devoluciones, incluyendo el control de estados desde la solicitud inicial hasta la resolución final. Cada transición de estado debe quedar auditada, proporcionando trazabilidad completa del proceso.</p>
</div>
<div class="paragraph">
<p>La plataforma incorpora una API de validación configurable que aplica reglas de negocio, comenzando con la validación del período de 5 días desde la compra.</p>
</div>
</div>
<div class="sect2">
<h3 id="restricciones-y-dependencias"><a class="anchor" href="#restricciones-y-dependencias"></a>5.3. Restricciones y dependencias</h3>
<div class="paragraph">
<p>La solución debe operar dentro del landscape tecnológico existente, manteniendo compatibilidad con sistemas legacy de punto de venta que presentan limitaciones técnicas específicas. El rendimiento debe garantizar latencias consistentemente bajas incluso durante picos de demanda que pueden alcanzar las 2.777 transacciones por segundo.</p>
</div>
</div>
<div class="sect2">
<h3 id="criterios-de-aceptación"><a class="anchor" href="#criterios-de-aceptación"></a>5.4. Criterios de aceptación</h3>
<div class="paragraph">
<p>Desde la perspectiva del cliente, el sistema se considera exitoso cuando permite completar una solicitud de devolución en menos de tres minutos, con confirmación inmediata y visibilidad completa del estado del trámite en todo momento. La experiencia debe ser consistentemente excelente a través de todos los canales digitales.</p>
</div>
<div class="paragraph">
<p>Para el personal de tienda, la solución debe demostrar su valor mediante la reducción significativa del tiempo de procesamiento por caso, el acceso inmediato a información relevante y la capacidad de resolver excepciones comunes sin escalamiento. La integración con los flujos de trabajo existentes debe ser fluida e intuitiva.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="estrategia-de-lanzamiento"><a class="anchor" href="#estrategia-de-lanzamiento"></a>6. ESTRATEGIA DE LANZAMIENTO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="plan-de-release-por-fases"><a class="anchor" href="#plan-de-release-por-fases"></a>6.1. Plan de Release por Fases</h3>
<hr>
<div class="paragraph">
<p>title Plan de Implementación
---</p>
</div>
<div class="paragraph">
<p>projectscale quarterly
[Fase 1 - MVP] lasts from 2024-01-15 to 2024-02-29
[Core API] lasts from 2024-01-15 to 2024-02-15
[Integración POS] lasts from 2024-01-15 to 2024-02-29
[Dashboard básico] lasts from 2024-02-01 to 2024-03-02</p>
</div>
<div class="paragraph">
<p>[Fase 2 - Escalabilidad] lasts from 2024-03-01 to 2024-04-15
[Auto-scaling] lasts from 2024-03-01 to 2024-03-31
[Cache Redis] lasts from 2024-03-15 to 2024-04-05
[Monitoring] lasts from 2024-03-20 to 2024-04-15</p>
</div>
<div class="paragraph">
<p>[Fase 3 - Optimización] lasts from 2024-04-15 to 2024-06-15
[Machine Learning] lasts from 2024-04-15 to 2024-05-30
[Mobile PWA] lasts from 2024-05-01 to 2024-05-31
[Analytics avanzado] lasts from 2024-05-15 to 2024-06-15
---</p>
</div>
</div>
<div class="sect2">
<h3 id="áreas-impactadas-matriz-raci"><a class="anchor" href="#áreas-impactadas-matriz-raci"></a>6.2. Áreas Impactadas - Matriz RACI</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Área</th>
<th class="tableblock halign-left valign-top">Responsable</th>
<th class="tableblock halign-left valign-top">Aprobador</th>
<th class="tableblock halign-left valign-top">Consultado</th>
<th class="tableblock halign-left valign-top">Informado</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operaciones TI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiendas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Finanzas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preguntas-y-respuestas"><a class="anchor" href="#preguntas-y-respuestas"></a>7. PREGUNTAS Y RESPUESTAS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="preguntas-abiertas-críticas"><a class="anchor" href="#preguntas-abiertas-críticas"></a>7.1. Preguntas Abiertas Críticas</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Integración legacy</strong>: ¿Cómo manejar tiendas con sistemas POS antiguos sin API?</p>
<div class="paragraph">
<p><strong>Respuesta pendiente: Evaluar middleware o terminales intermedias</strong></p>
</div>
</li>
<li>
<p><strong>Data migration</strong>: ¿Migración histórica de devoluciones o solo datos nuevos?</p>
<div class="paragraph">
<p><strong>Respuesta: Solo datos nuevos inicialmente, históricos en fase 2</strong></p>
</div>
</li>
<li>
<p><strong>Disponibilidad</strong>: ¿Plan de contingencia para caídas de sistemas dependientes?</p>
<div class="paragraph">
<p><strong>Respuesta pendiente: Definir circuit breakers y colas de retry</strong></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="faq-preguntas-frecuentes"><a class="anchor" href="#faq-preguntas-frecuentes"></a>7.2. FAQ - Preguntas Frecuentes</h3>
<div class="paragraph">
<p><strong>Q: ¿Qué pasa si el sistema de inventario está caído?</strong>
<strong>R</strong>: Modo degradado con cola de sincronización y validación manual temporal.</p>
</div>
<div class="paragraph">
<p><strong>Q: ¿Cómo se manejan devoluciones sin recibo físico?</strong>
<strong>R</strong>: Búsqueda por email/teléfono + validación con datos de pago.</p>
</div>
<div class="paragraph">
<p><strong>Q: ¿Límite de devoluciones por cliente?</strong>
<strong>R</strong>: Sí, 3 devoluciones/mes para clientes regulares, 1 para nuevos.</p>
</div>
<div class="paragraph">
<p><strong>Q: ¿Tiempo de reembolso?</strong>
<strong>R</strong>: 24-48 horas para tarjetas, 5-7 días para transferencias.</p>
</div>
<div class="paragraph">
<p><strong>Q: ¿Productos no elegibles?</strong>
<strong>R</strong>: Ropa interior, productos personalizados, software abierto.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contingencias-y-riesgos"><a class="anchor" href="#contingencias-y-riesgos"></a>8. CONTINGENCIAS Y RIESGOS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="plan-de-mitigación"><a class="anchor" href="#plan-de-mitigación"></a>8.1. Plan de Mitigación</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Riesgo</th>
<th class="tableblock halign-left valign-top">Probabilidad</th>
<th class="tableblock halign-left valign-top">Impacto</th>
<th class="tableblock halign-left valign-top">Mitigación</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caída sistema POS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Media</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cache local + sync async</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pico de transacciones</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alta</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-scaling + rate limiting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error en motor reglas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Baja</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit trail + rollback manual</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brecha seguridad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Media</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encryption + pentesting regular</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="diagrama-c4"><a class="anchor" href="#diagrama-c4"></a>9. DIAGRAMA C4</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="nivel-1-contexto-del-sistema"><a class="anchor" href="#nivel-1-contexto-del-sistema"></a>9.1. Nivel 1 - Contexto del Sistema</h3>
<hr>
<div class="paragraph">
<p>title Contexto del Sistema - Nivel 1
---</p>
</div>
<div class="paragraph">
<p>left to right direction
actor "Cliente" as client
rectangle "Sistema Devoluciones" as returns
rectangle "Sistema Retail" as retail
rectangle "Proveedor Pago" as payment</p>
</div>
<div class="paragraph">
<p>client -&#8594; returns
returns -&#8594; retail
returns -&#8594; payment
---</p>
</div>
</div>
<div class="sect2">
<h3 id="nivel-2-contenedores"><a class="anchor" href="#nivel-2-contenedores"></a>9.2. Nivel 2 - Contenedores</h3>
<hr>
<div class="paragraph">
<p>title Contenedores - Nivel 2
---</p>
</div>
<div class="paragraph">
<p>node "Sistema Gestión Devoluciones" {
  [API Gateway\nKong] as gateway
  [Service Mesh\nIstio] as mesh
  [Message Queue\nKafka] as queue</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[Microservicio\nDevoluciones] as returns_ms
[Microservicio\nValidación] as validation_ms
[Cache Layer\nRedis Cluster] as cache</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[Database\nPostgreSQL] as db
[Data Warehouse\nBigQuery] as dw
[Monitoring\nPrometheus] as monitoring</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  gateway --&gt; returns_ms
  mesh --&gt; validation_ms
  queue --&gt; cache
  returns_ms --&gt; db
  validation_ms --&gt; dw
  monitoring --&gt; returns_ms
}
---</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="diagrama-entidad-relación"><a class="anchor" href="#diagrama-entidad-relación"></a>10. DIAGRAMA ENTIDAD-RELACIÓN</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">-- Tabla principal de devoluciones
CREATE TABLE returns (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    sale_id UUID NOT NULL,
    customer_id UUID NOT NULL,
    status VARCHAR(50) NOT NULL CHECK (status IN ('pending', 'approved', 'rejected', 'processed')),
    return_reason VARCHAR(200) NOT NULL,
    total_amount DECIMAL(10,2) NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    processed_by UUID,
    notes TEXT
);

-- Items de devolución
CREATE TABLE return_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    return_id UUID REFERENCES returns(id) ON DELETE CASCADE,
    product_id UUID NOT NULL,
    quantity INTEGER NOT NULL CHECK (quantity &gt; 0),
    unit_price DECIMAL(10,2) NOT NULL,
    reason VARCHAR(100) NOT NULL,
    condition VARCHAR(50) CHECK (condition IN ('new', 'opened', 'damaged'))
);

-- Tabla de políticas de devolución
CREATE TABLE return_policies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_category VARCHAR(100) NOT NULL,
    return_window_days INTEGER NOT NULL,
    restocking_fee DECIMAL(5,2) DEFAULT 0,
    requires_receipt BOOLEAN DEFAULT true,
    active BOOLEAN DEFAULT true
);

-- Índices para performance
CREATE INDEX CONCURRENTLY idx_returns_sale_id ON returns(sale_id);
CREATE INDEX CONCURRENTLY idx_returns_customer_id ON returns(customer_id);
CREATE INDEX CONCURRENTLY idx_returns_status ON returns(status);
CREATE INDEX CONCURRENTLY idx_returns_created_at ON returns(created_at);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture-decision-records-adr"><a class="anchor" href="#architecture-decision-records-adr"></a>11. ARCHITECTURE DECISION RECORDS (ADR)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="adr-001-microservicios-vs-monolito"><a class="anchor" href="#adr-001-microservicios-vs-monolito"></a>11.1. ADR 001: Microservicios vs Monolito</h3>
<div class="paragraph">
<p><strong>Fecha</strong>: 2024-01-15
<strong>Estado</strong>: Aceptado
<strong>Contexto</strong>: Necesidad de manejar 10M transacciones diarias con alta disponibilidad
<strong>Decisión</strong>: Arquitectura de microservicios
<strong>Consecuencias</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>✅ Mejor escalabilidad horizontal</p>
</li>
<li>
<p>✅ Deployment independiente por equipo</p>
</li>
<li>
<p>✅ Resiliencia mejorada</p>
</li>
<li>
<p>⚠️ Mayor complejidad operacional</p>
</li>
<li>
<p>⚠️ Overhead de comunicación entre servicios</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adr-002-estrategia-de-base-de-datos"><a class="anchor" href="#adr-002-estrategia-de-base-de-datos"></a>11.2. ADR 002: Estrategia de Base de Datos</h3>
<div class="paragraph">
<p><strong>Fecha</strong>: 2024-01-15
<strong>Estado</strong>: Aceptado
<strong>Contexto</strong>: Alto volumen transaccional con requerimientos de consistencia
<strong>Decisión</strong>: PostgreSQL con particionamiento + Redis para cache
<strong>Consecuencias</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>✅ ACID compliance para transacciones financieras</p>
</li>
<li>
<p>✅ Particionamiento por fecha para performance</p>
</li>
<li>
<p>✅ Redis para queries frecuentes</p>
</li>
<li>
<p>⚠️ Complejidad de mantenimiento</p>
</li>
<li>
<p>⚠️ Costo de infraestructura mayor</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="especificación-de-endpoints"><a class="anchor" href="#especificación-de-endpoints"></a>12. ESPECIFICACIÓN DE ENDPOINTS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="crear-devolución"><a class="anchor" href="#crear-devolución"></a>12.1. Crear Devolución</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">POST /api/v1/returns
Content-Type: application/json
Authorization: Bearer {token}

{
  "sale_id": "uuid",
  "items": [
    {
      "product_id": "uuid",
      "quantity": 1,
      "reason": "defective"
    }
  ],
  "customer_notes": "string"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="consultar-estado"><a class="anchor" href="#consultar-estado"></a>12.2. Consultar Estado</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">GET /api/v1/returns/{return_id}
Authorization: Bearer {token}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="procesar-devolución"><a class="anchor" href="#procesar-devolución"></a>12.3. Procesar Devolución</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">PATCH /api/v1/returns/{return_id}/process
Authorization: Bearer {token}

{
  "action": "approve|reject",
  "admin_notes": "string"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="estrategia-de-implementación"><a class="anchor" href="#estrategia-de-implementación"></a>13. ESTRATEGIA DE IMPLEMENTACIÓN</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="fase-1-mvp-6-semanas"><a class="anchor" href="#fase-1-mvp-6-semanas"></a>13.1. Fase 1 (MVP - 6 semanas)</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Core API devoluciones</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Integración básica con sistema de ventas</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Dashboard administrativo básico</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="fase-2-8-semanas"><a class="anchor" href="#fase-2-8-semanas"></a>13.2. Fase 2 (8 semanas)</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Sistema de notificaciones</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Analytics y reporting</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Optimizaciones de performance</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="fase-3-6-semanas"><a class="anchor" href="#fase-3-6-semanas"></a>13.3. Fase 3 (6 semanas)</h3>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Mobile PWA</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Integraciones avanzadas</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Auto-scaling configuration</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stack-tecnológico"><a class="anchor" href="#stack-tecnológico"></a>14. STACK TECNOLÓGICO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="backend"><a class="anchor" href="#backend"></a>14.1. Backend</h3>
<div class="ulist">
<ul>
<li>
<p><strong>API Gateway</strong>: Kong</p>
</li>
<li>
<p><strong>Microservicios</strong>: Node.js/TypeScript</p>
</li>
<li>
<p><strong>Base de datos</strong>: PostgreSQL 14+</p>
</li>
<li>
<p><strong>Cache</strong>: Redis Cluster</p>
</li>
<li>
<p><strong>Message Queue</strong>: Apache Kafka</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="frontend"><a class="anchor" href="#frontend"></a>14.2. Frontend</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Admin Panel</strong>: AdminLTE + React</p>
</li>
<li>
<p><strong>Mobile</strong>: Framework7 PWA</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devops"><a class="anchor" href="#devops"></a>14.3. DevOps</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Containerization</strong>: Docker + Kubernetes</p>
</li>
<li>
<p><strong>CI/CD</strong>: GitLab CI</p>
</li>
<li>
<p><strong>Monitoring</strong>: Prometheus + Grafana</p>
</li>
<li>
<p><strong>Documentation</strong>: Antora</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Esta documentación proporciona una base sólida para el desarrollo de la API de gestión de devoluciones, considerando los altos requisitos de performance y escalabilidad especificados.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Example Documentation</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="./_/js/site.js" data-ui-root-path="./_"></script>
<script async src="./_/js/vendor/highlight.js"></script>
<script src="./_/js/vendor/lunr.js"></script>
<script src="./_/js/search-ui.js" id="search-ui-script" data-site-root-path="." data-snippet-length="100" data-stylesheet="./_/css/search.css"></script>
<script async src="./search-index.js"></script>
  </body>
</html>
